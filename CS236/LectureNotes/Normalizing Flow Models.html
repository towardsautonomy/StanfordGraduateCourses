<!DOCTYPE html>
<html><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Normalizing Flow Models</title>
  <meta name="description" content="Lecture notes for Deep Generative Models.">


  <link rel="stylesheet" href="Normalizing%20Flow%20Models_files/tufte.css">	
  

  <!-- Google Fonts loaded here depending on setting in _data/options.yml true loads font, blank does not-->
  
    <link href="Normalizing%20Flow%20Models_files/css.css" rel="stylesheet" type="text/css">
  
  <!-- Load up MathJax script if needed ... specify in /_data/options.yml file-->
  
    <script async="" src="Normalizing%20Flow%20Models_files/analytics.js"></script><script src="Normalizing%20Flow%20Models_files/MathJax.js" id=""></script>
  

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-129020129-1', 'auto');
  ga('send', 'pageview');

  </script>

  <link rel="canonical" href="http://localhost:4000/notes/flow/">
  <link rel="alternate" type="application/rss+xml" title="Deep Generative Models" href="http://localhost:4000/notes/feed.xml">
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1px; bottom: 2px; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype'); font-weight: bold}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Math; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype'); font-style: italic}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">@font-face {font-family: MathJax_AMS; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_AMS-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_AMS-Regular.otf?V=2.7.1') format('opentype')}
</style></head>

  <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px none; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>
    <!--- Header and nav template site-wide -->
<header>
    <nav class="group">
        <a href="https://deepgenerativemodels.github.io/notes/">Contents</a>
	<a href="http://deepgenerativemodels.github.io/">Class</a>
	<a href="http://github.com/deepgenerativemodels/notes">Github</a>
	</nav>
</header>

    <article class="group">
      <h1>Normalizing flow models</h1>
<p class="subtitle"></p>


<script type="text/x-mathjax-config;executed=true">
  MathJax.Hub.Config({
    TeX: {
      Macros: {
        e: "\\epsilon",
        xti: "x^{(i)}",
        yti: "y^{(i)}",
        bfy: "{\\bf y}",
        bfx: "{\\bf x}",
        bfg: "{\\bf g}",
        bfbeta: "{\\bf \\beta}",
        tp: "\\tilde p",
        pt: "p_\\theta",
        Exp: "{\\mathbb{E}}",
        Ind: "{\\mathbb{I}}",
        KL: "{\\mathbb{KL}}",
        Dc: "{\\mathcal{D}}",
        Tc: "{\\mathcal{T}}",
        Xc: "{\\mathcal{X}}",
        note: ["\\textcolor{blue}{[NOTE: #1]}",1]
      }
    }
  });
</script>


<p>We continue our study over another type of likelihood based 
generative models. As before, we assume we are given access to a dataset
 <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi class=&quot;MJX-tex-caligraphic&quot; mathvariant=&quot;script&quot;&gt;D&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.78em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.78em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Caligraphic;">D</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi class="MJX-tex-caligraphic" mathvariant="script">D</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1">\mathcal{D}</script> of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 0.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.652em, 1000.6em, 2.351em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.06em; border-left: 0px solid; width: 0px; height: 0.621em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-2">n</script>-dimensional datapoints <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 0.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.732em, 1000.6em, 2.422em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="texatom" id="MathJax-Span-11"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.61em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-3">\mathbf{x}</script>. So far we have learned two types of likelihood based generative models:</p>

<ol>
  <li>
    <p>Autoregressive Models: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x220F;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;N&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo fence=&quot;false&quot; stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;lt;&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-14" style="width: 11.948em; display: inline-block;"><span style="display: inline-block; position: relative; width: 10.304em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.216em, 1010.21em, 2.715em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-15"><span class="msubsup" id="MathJax-Span-16"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.5em, 4.299em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.503em;"><span class="mi" id="MathJax-Span-18" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-20"><span class="mrow" id="MathJax-Span-21"><span class="mi" id="MathJax-Span-22" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-23" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-24" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="munderover" id="MathJax-Span-25" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 2.167em; height: 0px;"><span style="position: absolute; clip: rect(3.109em, 1000.89em, 4.355em, -1000em); top: -3.982em; left: 0em;"><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Size1; vertical-align: 0em;">∏</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.376em, 1000.7em, 4.105em, -1000em); top: -4.459em; left: 0.944em;"><span class="texatom" id="MathJax-Span-27"><span class="mrow" id="MathJax-Span-28"><span class="mi" id="MathJax-Span-29" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1001.22em, 4.113em, -1000em); top: -3.697em; left: 0.944em;"><span class="texatom" id="MathJax-Span-30"><span class="mrow" id="MathJax-Span-31"><span class="mi" id="MathJax-Span-32" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-33" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-34" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-35" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.5em, 4.299em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-36" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.503em;"><span class="mi" id="MathJax-Span-37" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-39"><span style="display: inline-block; position: relative; width: 0.891em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.52em, 4.116em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-40" style="font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.572em;"><span class="mi" id="MathJax-Span-41" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">|</span><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 1.476em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.59em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-44"><span class="mrow" id="MathJax-Span-45"><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.607em;"><span class="texatom" id="MathJax-Span-47"><span class="mrow" id="MathJax-Span-48"><span class="mo" id="MathJax-Span-49" style="font-size: 70.7%; font-family: MathJax_Main;">&lt;</span><span class="mi" id="MathJax-Span-50" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">i</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.388em; border-left: 0px solid; width: 0px; height: 1.549em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><munderover><mo>∏</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>N</mi></mrow></munderover><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mi>i</mi></msub><mo fence="false" stretchy="false">|</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo>&lt;</mo><mi>i</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">% <![CDATA[
p_\theta(\mathbf{x}) = \prod_{i=1}^{N} p_\theta(x_i \vert \mathbf{x}_{<i}) %]]></script></p>
  </li>
  <li>
    <p>Variational autoencoders: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x222B;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mtext&gt;d&lt;/mtext&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-52" style="width: 10.142em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.744em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1008.7em, 2.769em, -1000em); top: -2.34em; left: 0em;"><span class="mrow" id="MathJax-Span-53"><span class="msubsup" id="MathJax-Span-54"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.5em, 4.299em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.503em;"><span class="mi" id="MathJax-Span-56" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-57" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-58"><span class="mrow" id="MathJax-Span-59"><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mo" id="MathJax-Span-63" style="font-family: MathJax_Size1; text-rendering: optimizelegibility; vertical-align: 0em; padding-left: 0.278em;">∫<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.138em;"></span></span><span class="msubsup" id="MathJax-Span-64" style="padding-left: 0.167em;"><span style="display: inline-block; position: relative; width: 0.91em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.5em, 4.299em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-65" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.503em;"><span class="mi" id="MathJax-Span-66" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-68"><span class="mrow" id="MathJax-Span-69"><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-71" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-72" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-73"><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">)</span><span class="mtext" id="MathJax-Span-76" style="font-family: MathJax_Main;">d</span><span class="texatom" id="MathJax-Span-77"><span class="mrow" id="MathJax-Span-78"><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.34em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.402em; border-left: 0px solid; width: 0px; height: 1.384em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mo>∫</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo><mtext>d</mtext><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-5">p_\theta(\mathbf{x}) = \int p_\theta(\mathbf{x}, \mathbf{z}) \text{d}\mathbf{z}</script></p>
  </li>
</ol>

<p>The two methods have relative strengths and weaknesses. 
Autoregressive models provide tractable likelihoods but no direct 
mechanism for learning features, whereas variational autoencoders can 
learn feature representations but have intractable marginal likelihoods.</p>

<p>In this section, we introduce normalizing flows a type of method that
 combines the best of both worlds, allowing both feature learning and 
tractable marginal likelihood estimation.</p>

<h1 id="change-of-variables-formula">Change of Variables Formula</h1>

<p>In normalizing flows, we wish to map simple distributions (easy to 
sample and evaluate densities) to complex ones (learned via data). The 
change of variables formula describe how to evaluate densities of a 
random variable that is a deterministic transformation from another 
variable.</p>

<p><strong>Change of Variables</strong>: <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-80" style="width: 0.864em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.739em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.74em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-81"><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi></math></span></span><script type="math/tex" id="MathJax-Element-6">Z</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-83" style="width: 1.028em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.862em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.86em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-84"><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-7">X</script> be random variables which are related by a mapping <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-86" style="width: 6.242em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.378em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.371em, 1005.38em, 2.545em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-87"><span class="mi" id="MathJax-Span-88" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-89" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="msubsup" id="MathJax-Span-90" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.221em; height: 0px;"><span style="position: absolute; clip: rect(3.176em, 1000.71em, 4.106em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-91"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.392em; left: 0.722em;"><span class="mi" id="MathJax-Span-94" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-95" style="font-family: MathJax_Main; padding-left: 0.278em;">→</span><span class="msubsup" id="MathJax-Span-96" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.221em; height: 0px;"><span style="position: absolute; clip: rect(3.176em, 1000.71em, 4.106em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-97"><span class="mrow" id="MathJax-Span-98"><span class="mi" id="MathJax-Span-99" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.392em; left: 0.722em;"><span class="mi" id="MathJax-Span-100" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.285em; border-left: 0px solid; width: 0px; height: 1.171em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mo>:</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>n</mi></msup><mo stretchy="false">→</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-8">f: \mathbb{R}^n \to \mathbb{R}^n</script> such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-101" style="width: 4.928em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.228em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1004.13em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-102"><span class="mi" id="MathJax-Span-103" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-104" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-105" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.278em;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-106" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-108" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">X = f(Z)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-109" style="width: 6.16em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.296em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.26em, 1005.2em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-110"><span class="mi" id="MathJax-Span-111" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-112" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-113" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-114" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.618em;"><span class="texatom" id="MathJax-Span-115"><span class="mrow" id="MathJax-Span-116"><span class="mo" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-118" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-119" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-121" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.352em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi><mo>=</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-10">Z = f^{-1}(X)</script>. Then</p>

<div class="mathblock"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-122" style="width: 18.776em; display: inline-block;"><span style="display: inline-block; position: relative; width: 16.169em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(2.772em, 1016.05em, 5.541em, -1000em); top: -4.406em; left: 0em;"><span class="mrow" id="MathJax-Span-123"><span class="msubsup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 1.18em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.5em, 4.294em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.503em;"><span class="mi" id="MathJax-Span-126" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-127" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-128"><span class="mrow" id="MathJax-Span-129"><span class="mi" id="MathJax-Span-130" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-131" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-133" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.5em, 4.294em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-134" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.503em;"><span class="mi" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-137"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.55em, 4.305em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -4.398em; left: 0.618em;"><span class="texatom" id="MathJax-Span-139"><span class="mrow" id="MathJax-Span-140"><span class="mo" id="MathJax-Span-141" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-142" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-143" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-144"><span class="mrow" id="MathJax-Span-145"><span class="mi" id="MathJax-Span-146" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-148" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-149" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-150" style="vertical-align: 1.52em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.694em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.465em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mrow" id="MathJax-Span-151"><span class="mtext" id="MathJax-Span-152" style="font-family: MathJax_Main;">det</span><span class="mrow" id="MathJax-Span-153" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-154" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-155"><span style="display: inline-block; position: relative; width: 3.589em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.036em, 1003.37em, 4.35em, -1000em); top: -4.67em; left: 50%; margin-left: -1.734em;"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="msubsup" id="MathJax-Span-158"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.55em, 4.305em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-159" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -4.348em; left: 0.618em;"><span class="texatom" id="MathJax-Span-160"><span class="mrow" id="MathJax-Span-161"><span class="mo" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-163" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-164" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-168" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.155em, 1001.08em, 4.122em, -1000em); top: -3.299em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-169"><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="texatom" id="MathJax-Span-171"><span class="mrow" id="MathJax-Span-172"><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(0.898em, 1003.59em, 1.188em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.6px solid; width: 3.589em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-174" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span class="mo" id="MathJax-Span-175" style="vertical-align: 1.52em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.694em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.465em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.406em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.227em; border-left: 0px solid; width: 0px; height: 3.034em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>p</mi><mi>X</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><msub><mi>p</mi><mi>Z</mi></msub><mo stretchy="false">(</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow><mo>|</mo><mrow><mtext>det</mtext><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow></mrow></mfrac><mo>)</mo></mrow></mrow><mo>|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-11">p_X(\mathbb{x}) = p_Z(f^{-1}(\mathbb{x})) \left\vert \text{det}\left(\frac{\partial f^{-1}(\mathbb{x})}{\partial \mathbb{x}}\right) \right\vert

</script></div>

<p>There are several things to note here.</p>

<ol>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.663em, 1000.52em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="mi" id="MathJax-Span-180" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.595em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-12">\mathbb{x}</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-181" style="width: 0.536em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.452em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.663em, 1000.41em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-182"><span class="texatom" id="MathJax-Span-183"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Main;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.595em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-13">\mathbb{z}</script> need to be continuous and have the same dimension.</p>
  </li>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-186" style="width: 3.286em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.833em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.891em, 1002.83em, 2.748em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-187"><span class="mfrac" id="MathJax-Span-188"><span style="display: inline-block; position: relative; width: 2.587em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.22em, 1002.4em, 4.282em, -1000em); top: -4.546em; left: 50%; margin-left: -1.234em;"><span class="mrow" id="MathJax-Span-189"><span class="mi" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-191"><span style="display: inline-block; position: relative; width: 1.144em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.39em, 4.25em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-192" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.287em; left: 0.452em;"><span class="texatom" id="MathJax-Span-193"><span class="mrow" id="MathJax-Span-194"><span class="mo" id="MathJax-Span-195" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-196" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-197" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-198"><span class="mrow" id="MathJax-Span-199"><span class="mi" id="MathJax-Span-200" style="font-size: 70.7%; font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-201" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.77em, 4.121em, -1000em); top: -3.589em; left: 50%; margin-left: -0.387em;"><span class="mrow" id="MathJax-Span-202"><span class="mi" id="MathJax-Span-203" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="mi" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(0.884em, 1002.59em, 1.19em, -1000em); top: -1.287em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.5px solid; width: 2.587em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.521em; border-left: 0px solid; width: 0px; height: 1.963em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-14">\frac{\partial f^{-1}(\mathbb{x})}{\partial \mathbb{x}}</script> is a matrix of dimension <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;&amp;#x00D7;&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-207" style="width: 2.835em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.422em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.603em, 1002.4em, 2.351em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-208"><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-210" style="font-family: MathJax_Main; padding-left: 0.222em;">×</span><span class="mi" id="MathJax-Span-211" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">n</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.06em; border-left: 0px solid; width: 0px; height: 0.678em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>×</mo><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">n \times n</script>, where each entry at location <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-212" style="width: 2.301em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.97em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1001.88em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-213"><span class="mo" id="MathJax-Span-214" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">j</span><span class="mo" id="MathJax-Span-218" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>i</mi><mo>,</mo><mi>j</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-16">(i, j)</script> is defined as <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;j&lt;/mi&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-219" style="width: 3.532em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.038em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.861em, 1003.04em, 2.941em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-220"><span class="mfrac" id="MathJax-Span-221"><span style="display: inline-block; position: relative; width: 2.813em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.22em, 1002.69em, 4.312em, -1000em); top: -4.576em; left: 50%; margin-left: -1.346em;"><span class="mrow" id="MathJax-Span-222"><span class="mi" id="MathJax-Span-223" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-224"><span style="display: inline-block; position: relative; width: 1.144em; height: 0px;"><span style="position: absolute; clip: rect(3.36em, 1000.39em, 4.25em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-225" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.287em; left: 0.452em;"><span class="texatom" id="MathJax-Span-226"><span class="mrow" id="MathJax-Span-227"><span class="mo" id="MathJax-Span-228" style="font-size: 50%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-229" style="font-size: 50%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-230" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-231"><span class="mrow" id="MathJax-Span-232"><span class="mi" id="MathJax-Span-233" style="font-size: 70.7%; font-family: MathJax_Main;">x</span></span></span><span class="msubsup" id="MathJax-Span-234"><span style="display: inline-block; position: relative; width: 0.501em; height: 0px;"><span style="position: absolute; clip: rect(3.328em, 1000.21em, 4.282em, -1000em); top: -3.982em; left: 0em;"><span class="mo" id="MathJax-Span-235" style="font-size: 70.7%; font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.78em; left: 0.275em;"><span class="mi" id="MathJax-Span-236" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">i</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1001.06em, 4.313em, -1000em); top: -3.589em; left: 50%; margin-left: -0.532em;"><span class="mrow" id="MathJax-Span-237"><span class="mi" id="MathJax-Span-238" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="msubsup" id="MathJax-Span-239"><span style="display: inline-block; position: relative; width: 0.663em; height: 0px;"><span style="position: absolute; clip: rect(3.546em, 1000.37em, 4.113em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-240" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">x</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.876em; left: 0.404em;"><span class="mi" id="MathJax-Span-241" style="font-size: 50%; font-family: MathJax_Math; font-style: italic;">j</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(0.884em, 1002.81em, 1.19em, -1000em); top: -1.287em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.5px solid; width: 2.813em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.744em; border-left: 0px solid; width: 0px; height: 2.222em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfrac><mrow><mi mathvariant="normal">∂</mi><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><msub><mo stretchy="false">)</mo><mi>i</mi></msub></mrow><mrow><mi mathvariant="normal">∂</mi><msub><mi>x</mi><mi>j</mi></msub></mrow></mfrac></math></span></span><script type="math/tex" id="MathJax-Element-17">\frac{\partial f^{-1}(\mathbb{x})_i}{\partial x_j}</script>. This matrix is also known as the Jacobian matrix.</p>
  </li>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-242" style="width: 3.409em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.915em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1002.82em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-243"><span class="mtext" id="MathJax-Span-244" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-245" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-247" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>det</mtext><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-18">\text{det}(A)</script> denotes the determinant of a square matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-248" style="width: 0.864em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.739em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.378em, 1000.72em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.926em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">A</script>.</p>
  </li>
  <li>
    <p>For any invertible matrix <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-251" style="width: 0.864em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.739em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.378em, 1000.72em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-252"><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.926em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">A</script>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;A&lt;/mi&gt;&lt;msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-254" style="width: 10.593em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.113em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.26em, 1009.11em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-255"><span class="mtext" id="MathJax-Span-256" style="font-family: MathJax_Main;">det</span><span class="mo" id="MathJax-Span-257" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-258"><span style="display: inline-block; position: relative; width: 1.729em; height: 0px;"><span style="position: absolute; clip: rect(3.143em, 1000.73em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-259" style="font-family: MathJax_Math; font-style: italic;">A</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.75em;"><span class="texatom" id="MathJax-Span-260"><span class="mrow" id="MathJax-Span-261"><span class="mo" id="MathJax-Span-262" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-263" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-264" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mtext" id="MathJax-Span-266" style="font-family: MathJax_Main; padding-left: 0.278em;">det</span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-268" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="msubsup" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 1.368em; height: 0px;"><span style="position: absolute; clip: rect(3.109em, 1000.29em, 4.355em, -1000em); top: -3.982em; left: 0em;"><span class="mo" id="MathJax-Span-270" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.389em;"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mo" id="MathJax-Span-273" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-274" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.352em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>det</mtext><mo stretchy="false">(</mo><msup><mi>A</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">)</mo><mo>=</mo><mtext>det</mtext><mo stretchy="false">(</mo><mi>A</mi><msup><mo stretchy="false">)</mo><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span><script type="math/tex" id="MathJax-Element-21">\text{det}(A^{-1}) = \text{det}(A)^{-1}</script>, so for <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-275" style="width: 5.462em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.68em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.26em, 1004.59em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-276"><span class="texatom" id="MathJax-Span-277"><span class="mrow" id="MathJax-Span-278"><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Main;">z</span></span></span><span class="mo" id="MathJax-Span-280" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-281" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.618em;"><span class="texatom" id="MathJax-Span-283"><span class="mrow" id="MathJax-Span-284"><span class="mo" id="MathJax-Span-285" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-286" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-287" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-288"><span class="mrow" id="MathJax-Span-289"><span class="mi" id="MathJax-Span-290" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-291" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.352em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow><mo>=</mo><msup><mi>f</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">\mathbb{z} = f^{-1}(\mathbb{x})</script> we have</p>

    <div class="mathblock"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-292" style="width: 15.557em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.41em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(0.498em, 1013.41em, 3.325em, -1000em); top: -2.261em; left: 0em;"><span class="mrow" id="MathJax-Span-293"><span class="msubsup" id="MathJax-Span-294"><span style="display: inline-block; position: relative; width: 1.18em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.5em, 4.294em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-295" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.503em;"><span class="mi" id="MathJax-Span-296" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-297" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-298"><span class="mrow" id="MathJax-Span-299"><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-301" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-303" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.5em, 4.294em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-304" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.503em;"><span class="mi" id="MathJax-Span-305" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-307"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Main;">z</span></span></span><span class="mo" id="MathJax-Span-310" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 7.261em; height: 0px;"><span style="position: absolute; clip: rect(2.42em, 1006.16em, 5.049em, -1000em); top: -3.985em; left: 0em;"><span class="mrow" id="MathJax-Span-312"><span class="mo" id="MathJax-Span-313" style="vertical-align: 1.449em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.835em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.535em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mrow" id="MathJax-Span-314"><span class="mtext" id="MathJax-Span-315" style="font-family: MathJax_Main;">det</span><span class="mrow" id="MathJax-Span-316" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-317" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-318"><span style="display: inline-block; position: relative; width: 2.458em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.12em, 1002.24em, 4.35em, -1000em); top: -4.67em; left: 50%; margin-left: -1.169em;"><span class="mrow" id="MathJax-Span-319"><span class="mi" id="MathJax-Span-320" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-322" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-323"><span class="mrow" id="MathJax-Span-324"><span class="mi" id="MathJax-Span-325" style="font-family: MathJax_Main;">z</span></span></span><span class="mo" id="MathJax-Span-326" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.155em, 1000.97em, 4.122em, -1000em); top: -3.299em; left: 50%; margin-left: -0.505em;"><span class="mrow" id="MathJax-Span-327"><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="texatom" id="MathJax-Span-329"><span class="mrow" id="MathJax-Span-330"><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Main;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(0.898em, 1002.46em, 1.188em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.6px solid; width: 2.458em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-332" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span class="mo" id="MathJax-Span-333" style="vertical-align: 1.449em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.835em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.535em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -5.161em; left: 6.282em;"><span class="texatom" id="MathJax-Span-334"><span class="mrow" id="MathJax-Span-335"><span class="mo" id="MathJax-Span-336" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-337" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.261em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.146em; border-left: 0px solid; width: 0px; height: 3.101em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>p</mi><mi>X</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><msub><mi>p</mi><mi>Z</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow><mo stretchy="false">)</mo><msup><mrow><mo>|</mo><mrow><mtext>det</mtext><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow></mrow></mfrac><mo>)</mo></mrow></mrow><mo>|</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msup></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-23">

p_X(\mathbb{x}) = p_Z(\mathbb{z}) \left\vert \text{det}\left(\frac{\partial f(\mathbb{z})}{\partial \mathbb{z}}\right) \right\vert^{-1}

</script></div>
  </li>
  <li>
    <p>If <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-338" style="width: 8.294em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.143em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(2.627em, 1007.07em, 4.672em, -1000em); top: -3.9em; left: 0em;"><span class="mrow" id="MathJax-Span-339"><span class="mrow" id="MathJax-Span-340"><span class="mo" id="MathJax-Span-341" style="vertical-align: 1.149em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.232em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -2.432em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mrow" id="MathJax-Span-342"><span class="mtext" id="MathJax-Span-343" style="font-family: MathJax_Main;">det</span><span class="mrow" id="MathJax-Span-344" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-345" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">(</span></span><span class="mfrac" id="MathJax-Span-346"><span style="display: inline-block; position: relative; width: 1.773em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.328em, 1001.59em, 4.282em, -1000em); top: -4.546em; left: 50%; margin-left: -0.827em;"><span class="mrow" id="MathJax-Span-347"><span class="mi" id="MathJax-Span-348" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="mi" id="MathJax-Span-349" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.042em;"></span></span><span class="mo" id="MathJax-Span-350" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-351"><span class="mrow" id="MathJax-Span-352"><span class="mi" id="MathJax-Span-353" style="font-size: 70.7%; font-family: MathJax_Main;">z</span></span></span><span class="mo" id="MathJax-Span-354" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.353em, 1000.68em, 4.121em, -1000em); top: -3.589em; left: 50%; margin-left: -0.357em;"><span class="mrow" id="MathJax-Span-355"><span class="mi" id="MathJax-Span-356" style="font-size: 70.7%; font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.025em;"></span></span><span class="texatom" id="MathJax-Span-357"><span class="mrow" id="MathJax-Span-358"><span class="mi" id="MathJax-Span-359" style="font-size: 70.7%; font-family: MathJax_Main;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(0.884em, 1001.77em, 1.19em, -1000em); top: -1.287em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.5px solid; width: 1.773em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.067em;"></span></span></span></span><span class="mo" id="MathJax-Span-360" style="vertical-align: 0em;"><span style="font-family: MathJax_Size2;">)</span></span></span></span><span class="mo" id="MathJax-Span-361" style="vertical-align: 1.149em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.232em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -2.432em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-362" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mn" id="MathJax-Span-363" style="font-family: MathJax_Main; padding-left: 0.278em;">1</span></span><span style="display: inline-block; width: 0px; height: 3.9em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.801em; border-left: 0px solid; width: 0px; height: 2.182em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow><mo>|</mo><mrow><mtext>det</mtext><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow></mrow></mfrac><mo>)</mo></mrow></mrow><mo>|</mo></mrow><mo>=</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-24">\left \vert \text{det}\left(\frac{\partial f(\mathbb{z})}{\partial \mathbb{z}}\right) \right\vert = 1</script>, then the mappings is volume preserving, which means that the transformed distribution <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-364" style="width: 1.398em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.19em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.652em, 1001.19em, 2.534em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-365"><span class="msubsup" id="MathJax-Span-366"><span style="display: inline-block; position: relative; width: 1.18em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.5em, 4.299em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.503em;"><span class="mi" id="MathJax-Span-368" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.273em; border-left: 0px solid; width: 0px; height: 0.833em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>X</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-25">p_X</script> will have the same “volume” compared to the original one <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-369" style="width: 1.316em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.108em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.652em, 1001.11em, 2.534em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-370"><span class="msubsup" id="MathJax-Span-371"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.5em, 4.299em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-372" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.503em;"><span class="mi" id="MathJax-Span-373" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.273em; border-left: 0px solid; width: 0px; height: 0.833em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>p</mi><mi>Z</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-26">p_Z</script>.</p>
  </li>
</ol>

<h1 id="normalizing-flow-models">Normalizing Flow Models</h1>

<p>We are ready to introduce normalizing flow models. Let us consider a directed, latent-variable model over observed variables <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-374" style="width: 1.028em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.862em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.86em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-375"><span class="mi" id="MathJax-Span-376" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">X</script> and latent variables <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-377" style="width: 0.864em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.739em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.74em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-378"><span class="mi" id="MathJax-Span-379" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">Z</script>. In a <strong>normalizing flow model</strong>, the mapping between <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-380" style="width: 0.864em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.739em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.74em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-381"><span class="mi" id="MathJax-Span-382" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">Z</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-383" style="width: 1.028em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.862em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.411em, 1000.86em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-384"><span class="mi" id="MathJax-Span-385" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.888em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">X</script>, given by <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo&gt;:&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;R&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-386" style="width: 6.693em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.747em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.371em, 1005.75em, 2.545em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-387"><span class="msubsup" id="MathJax-Span-388"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-389" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.49em;"><span class="mi" id="MathJax-Span-390" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-391" style="font-family: MathJax_Main; padding-left: 0.278em;">:</span><span class="msubsup" id="MathJax-Span-392" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.221em; height: 0px;"><span style="position: absolute; clip: rect(3.176em, 1000.71em, 4.106em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-393"><span class="mrow" id="MathJax-Span-394"><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.392em; left: 0.722em;"><span class="mi" id="MathJax-Span-396" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-397" style="font-family: MathJax_Main; padding-left: 0.278em;">→</span><span class="msubsup" id="MathJax-Span-398" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.221em; height: 0px;"><span style="position: absolute; clip: rect(3.176em, 1000.71em, 4.106em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-399"><span class="mrow" id="MathJax-Span-400"><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_AMS;">R</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.392em; left: 0.722em;"><span class="mi" id="MathJax-Span-402" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">n</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.285em; border-left: 0px solid; width: 0px; height: 1.171em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>θ</mi></msub><mo>:</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>n</mi></msup><mo stretchy="false">→</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">R</mi></mrow><mi>n</mi></msup></math></span></span><script type="math/tex" id="MathJax-Element-31">f_\theta: \mathbb{R}^n \to \mathbb{R}^n</script>, is deterministic and invertible such that <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-403" style="width: 5.339em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.598em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1004.5em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-404"><span class="mi" id="MathJax-Span-405" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-406" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-407" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-408" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.49em;"><span class="mi" id="MathJax-Span-409" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-410" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-411" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-412" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>X</mi><mo>=</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>Z</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-32">X = f_\theta(Z)</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-413" style="width: 6.16em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.296em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.22em, 1005.2em, 2.681em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-414"><span class="mi" id="MathJax-Span-415" style="font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span><span class="mo" id="MathJax-Span-416" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-417" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.98em, 4.163em, -1000em); top: -4.384em; left: 0.618em;"><span class="texatom" id="MathJax-Span-419"><span class="mrow" id="MathJax-Span-420"><span class="mo" id="MathJax-Span-421" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-422" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1000.41em, 4.112em, -1000em); top: -3.648em; left: 0.49em;"><span class="mi" id="MathJax-Span-423" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-424" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.024em;"></span></span><span class="mo" id="MathJax-Span-426" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.443em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>Z</mi><mo>=</mo><msubsup><mi>f</mi><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">Z  = f_\theta^{-1}(X)</script><sup id="fnref:nf"><a href="#fn:nf" class="footnote">1</a></sup>.</p>

<p><img src="Normalizing%20Flow%20Models_files/flow-graphical.html" alt=""></p>

<p>Using change of variables, the marginal likelihood <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-427" style="width: 2.137em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.847em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1001.75em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-428"><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>p</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-34">p(x)</script> is given by</p>

<div class="mathblock"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;X&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;;&lt;/mo&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;p&lt;/mi&gt;&lt;mi&gt;Z&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-433" style="width: 19.964em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.203em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(3.078em, 1017.08em, 6.307em, -1000em); top: -4.943em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="msubsup" id="MathJax-Span-435"><span style="display: inline-block; position: relative; width: 1.18em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.5em, 4.294em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-436" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.503em;"><span class="mi" id="MathJax-Span-437" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">X<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.017em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-438" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-439"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-442" style="font-family: MathJax_Main;">;</span><span class="mi" id="MathJax-Span-443" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">θ</span><span class="mo" id="MathJax-Span-444" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-445" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-446" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.5em, 4.294em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math; font-style: italic;">p</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.503em;"><span class="mi" id="MathJax-Span-448" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">Z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.028em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-449" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-450"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.55em, 4.305em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-451" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.399em, 1000.98em, 4.158em, -1000em); top: -4.387em; left: 0.618em;"><span class="texatom" id="MathJax-Span-452"><span class="mrow" id="MathJax-Span-453"><span class="mo" id="MathJax-Span-454" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-455" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.371em, 1000.41em, 4.107em, -1000em); top: -3.651em; left: 0.49em;"><span class="mi" id="MathJax-Span-456" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-457" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-458"><span class="mrow" id="MathJax-Span-459"><span class="mi" id="MathJax-Span-460" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-461" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-462" style="font-family: MathJax_Main;">)</span><span class="mrow" id="MathJax-Span-463" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-464" style="vertical-align: 1.749em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.568em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.901em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mrow" id="MathJax-Span-465"><span class="mtext" id="MathJax-Span-466" style="font-family: MathJax_Main;">det</span><span class="mrow" id="MathJax-Span-467" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-468" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">(</span></span><span class="mfrac" id="MathJax-Span-469"><span style="display: inline-block; position: relative; width: 3.589em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(2.996em, 1003.37em, 4.441em, -1000em); top: -4.762em; left: 50%; margin-left: -1.734em;"><span class="mrow" id="MathJax-Span-470"><span class="mi" id="MathJax-Span-471" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="msubsup" id="MathJax-Span-472"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.55em, 4.305em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.399em, 1000.98em, 4.158em, -1000em); top: -4.387em; left: 0.618em;"><span class="texatom" id="MathJax-Span-474"><span class="mrow" id="MathJax-Span-475"><span class="mo" id="MathJax-Span-476" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-477" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.371em, 1000.41em, 4.107em, -1000em); top: -3.651em; left: 0.49em;"><span class="mi" id="MathJax-Span-478" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-479" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-480"><span class="mrow" id="MathJax-Span-481"><span class="mi" id="MathJax-Span-482" style="font-family: MathJax_Main;">x</span></span></span><span class="mo" id="MathJax-Span-483" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.155em, 1001.08em, 4.122em, -1000em); top: -3.299em; left: 50%; margin-left: -0.547em;"><span class="mrow" id="MathJax-Span-484"><span class="mi" id="MathJax-Span-485" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="texatom" id="MathJax-Span-486"><span class="mrow" id="MathJax-Span-487"><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(0.898em, 1003.59em, 1.188em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.6px solid; width: 3.589em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-489" style="vertical-align: 0em;"><span style="font-family: MathJax_Size4;">)</span></span></span></span><span class="mo" id="MathJax-Span-490" style="vertical-align: 1.749em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.568em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -1.901em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.943em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.494em; border-left: 0px solid; width: 0px; height: 3.568em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mi>p</mi><mi>X</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo>;</mo><mi>θ</mi><mo stretchy="false">)</mo><mo>=</mo><msub><mi>p</mi><mi>Z</mi></msub><mo stretchy="false">(</mo><msubsup><mi>f</mi><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mrow><mo>|</mo><mrow><mtext>det</mtext><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><msubsup><mi>f</mi><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow></mrow></mfrac><mo>)</mo></mrow></mrow><mo>|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-35">

p_X(\mathbb{x}; \theta) = p_Z(f_\theta^{-1}(\mathbb{x})) \left\vert \text{det}\left(\frac{\partial f^{-1}_\theta(\mathbb{x})}{\partial \mathbb{x}}\right) \right\vert

</script></div>

<p>The name “normalizing flow” can be interpreted as the following:</p>

<ol>
  <li>“Normalizing” means that the change of variables gives a normalized density after applying an invertible transformation.</li>
  <li>“Flow” means that the invertible transformations can be composed 
with each other to create more complex invertible transformations.</li>
</ol>

<p>Different from autoregressive model and variational autoencoders, 
deep normalizing flow models require specific architectural structures.</p>

<ol>
  <li>The input and output dimensions must be the same.</li>
  <li>The transformation must be invertible.</li>
  <li>Computing the determinant of the Jacobian needs to be efficient (and differentiable).</li>
</ol>

<p>Next, we introduce several popular forms of flow models that satisfy these properties.</p>

<p>The Planar Flow introduces the following invertible transformation</p>

<div class="mathblock"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;z&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-491" style="width: 14.83em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.759em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.299em, 1012.66em, 2.664em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-492"><span class="texatom" id="MathJax-Span-493"><span class="mrow" id="MathJax-Span-494"><span class="mi" id="MathJax-Span-495" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-496" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-497" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.55em, 4.305em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.49em;"><span class="mi" id="MathJax-Span-499" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-500" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-503" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="texatom" id="MathJax-Span-504" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-505"><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-507" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="texatom" id="MathJax-Span-508" style="padding-left: 0.222em;"><span class="mrow" id="MathJax-Span-509"><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Main; font-weight: bold;">u</span></span></span><span class="mi" id="MathJax-Span-511" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-512" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-513"><span style="display: inline-block; position: relative; width: 1.456em; height: 0px;"><span style="position: absolute; clip: rect(3.426em, 1000.81em, 4.104em, -1000em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-514"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -4.398em; left: 0.831em;"><span class="mi" id="MathJax-Span-517" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="texatom" id="MathJax-Span-518"><span class="mrow" id="MathJax-Span-519"><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-521" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-522" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-523" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.334em; border-left: 0px solid; width: 0px; height: 1.406em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo>=</mo><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow><mi>h</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-36">
\mathbf{x} = f_\theta(z) = \mathbf{z} + \mathbf{u} h(\mathbf{w}^\top \mathbf{z} + b)
</script></div>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-524" style="width: 3.245em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.791em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.482em, 1002.78em, 2.616em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-525"><span class="texatom" id="MathJax-Span-526"><span class="mrow" id="MathJax-Span-527"><span class="mi" id="MathJax-Span-528" style="font-family: MathJax_Main; font-weight: bold;">u</span></span></span><span class="mo" id="MathJax-Span-529" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-530" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-531"><span class="mi" id="MathJax-Span-532" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-533" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-534" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.273em; border-left: 0px solid; width: 0px; height: 1.125em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>,</mo><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">\mathbf{u}, \mathbf{w}, b</script> are parameters.</p>

<p>The absolute value of the determinant of the Jacobian is given by</p>

<div class="mathblock"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mtext&gt;det&lt;/mtext&gt;&lt;mrow&gt;&lt;mo&gt;(&lt;/mo&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x2202;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-535" style="width: 20.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 17.241em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(2.765em, 1017.12em, 5.394em, -1000em); top: -4.33em; left: 0em;"><span class="mrow" id="MathJax-Span-536"><span class="mrow" id="MathJax-Span-537"><span class="mo" id="MathJax-Span-538" style="vertical-align: 1.449em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.835em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.535em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mrow" id="MathJax-Span-539"><span class="mtext" id="MathJax-Span-540" style="font-family: MathJax_Main;">det</span><span class="mrow" id="MathJax-Span-541" style="padding-left: 0.167em;"><span class="mo" id="MathJax-Span-542" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">(</span></span><span class="mfrac" id="MathJax-Span-543"><span style="display: inline-block; position: relative; width: 2.458em; height: 0px; margin-right: 0.12em; margin-left: 0.12em;"><span style="position: absolute; clip: rect(3.12em, 1002.24em, 4.35em, -1000em); top: -4.67em; left: 50%; margin-left: -1.169em;"><span class="mrow" id="MathJax-Span-544"><span class="mi" id="MathJax-Span-545" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="mi" id="MathJax-Span-546" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mo" id="MathJax-Span-547" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-548"><span class="mrow" id="MathJax-Span-549"><span class="mi" id="MathJax-Span-550" style="font-family: MathJax_Main;">z</span></span></span><span class="mo" id="MathJax-Span-551" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(3.155em, 1000.97em, 4.122em, -1000em); top: -3.299em; left: 50%; margin-left: -0.505em;"><span class="mrow" id="MathJax-Span-552"><span class="mi" id="MathJax-Span-553" style="font-family: MathJax_Main;">∂<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.035em;"></span></span><span class="texatom" id="MathJax-Span-554"><span class="mrow" id="MathJax-Span-555"><span class="mi" id="MathJax-Span-556" style="font-family: MathJax_Main;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; clip: rect(0.898em, 1002.46em, 1.188em, -1000em); top: -1.293em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.6px solid; width: 2.458em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.073em;"></span></span></span></span><span class="mo" id="MathJax-Span-557" style="vertical-align: 0em;"><span style="font-family: MathJax_Size3;">)</span></span></span></span><span class="mo" id="MathJax-Span-558" style="vertical-align: 1.449em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -1.835em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="font-family: MathJax_Main; position: absolute; top: -2.535em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span><span class="mo" id="MathJax-Span-559" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mrow" id="MathJax-Span-560" style="padding-left: 0.278em;"><span class="mo" id="MathJax-Span-561" style="vertical-align: 0.885em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -2.963em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mrow" id="MathJax-Span-562"><span class="mn" id="MathJax-Span-563" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-564" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msup" id="MathJax-Span-565" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.176em, 1000.56em, 4.111em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-566" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -4.398em; left: 0.576em;"><span class="mo" id="MathJax-Span-567" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-568" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-569"><span style="display: inline-block; position: relative; width: 1.456em; height: 0px;"><span style="position: absolute; clip: rect(3.426em, 1000.81em, 4.104em, -1000em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-570"><span class="mrow" id="MathJax-Span-571"><span class="mi" id="MathJax-Span-572" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -4.398em; left: 0.831em;"><span class="mi" id="MathJax-Span-573" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="texatom" id="MathJax-Span-574"><span class="mrow" id="MathJax-Span-575"><span class="mi" id="MathJax-Span-576" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-577" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-578" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-579" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-580"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.42em, 1000.62em, 4.106em, -1000em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-581"><span class="mrow" id="MathJax-Span-582"><span class="mi" id="MathJax-Span-583" style="font-family: MathJax_Main; font-weight: bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -4.398em; left: 0.639em;"><span class="mi" id="MathJax-Span-584" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="texatom" id="MathJax-Span-585"><span class="mrow" id="MathJax-Span-586"><span class="mi" id="MathJax-Span-587" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span></span><span class="mo" id="MathJax-Span-588" style="vertical-align: 0.885em;"><span style="display: inline-block; position: relative; width: 0.278em; height: 0px;"><span style="position: absolute; font-family: MathJax_Main; top: -3.235em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; font-family: MathJax_Main; top: -2.963em; left: 0em;">∣<span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.33em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.146em; border-left: 0px solid; width: 0px; height: 2.872em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mrow><mo>|</mo><mrow><mtext>det</mtext><mrow><mo>(</mo><mfrac><mrow><mi mathvariant="normal">∂</mi><mi>f</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow><mo stretchy="false">)</mo></mrow><mrow><mi mathvariant="normal">∂</mi><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow></mrow></mfrac><mo>)</mo></mrow></mrow><mo>|</mo></mrow><mo>=</mo><mrow><mo>|</mo><mrow><mn>1</mn><mo>+</mo><msup><mi>h</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow></mrow><mo>|</mo></mrow></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-38">
\left\vert \text{det}\left(\frac{\partial f(\mathbb{z})}{\partial \mathbb{z}}\right) \right\vert = \left\vert 1 + h'(\mathbf{w}^\top \mathbf{z} + b) \mathbf{u}^\top \mathbf{w} \right\vert
</script></div>

<p>However,  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mo&gt;&amp;#x22C5;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-589" style="width: 5.667em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.885em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.426em, 1004.79em, 2.672em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-590"><span class="texatom" id="MathJax-Span-591"><span class="mrow" id="MathJax-Span-592"><span class="mi" id="MathJax-Span-593" style="font-family: MathJax_Main; font-weight: bold;">u</span></span></span><span class="mo" id="MathJax-Span-594" style="font-family: MathJax_Main;">,</span><span class="texatom" id="MathJax-Span-595" style="padding-left: 0.167em;"><span class="mrow" id="MathJax-Span-596"><span class="mi" id="MathJax-Span-597" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-598" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-599" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">b</span><span class="mo" id="MathJax-Span-600" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-601" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">h</span><span class="mo" id="MathJax-Span-602" style="font-family: MathJax_Main;">(</span><span class="mo" id="MathJax-Span-603" style="font-family: MathJax_Main;">⋅</span><span class="mo" id="MathJax-Span-604" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow><mo>,</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>,</mo><mi>b</mi><mo>,</mo><mi>h</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-39">\mathbf{u}, \mathbf{w}, b, h(\cdot)</script> need to be restricted in order to be invertible. For example, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;tanh&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-605" style="width: 4.518em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.9em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.4em, 1003.89em, 2.351em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-606"><span class="mi" id="MathJax-Span-607" style="font-family: MathJax_Math; font-style: italic;">h</span><span class="mo" id="MathJax-Span-608" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-609" style="font-family: MathJax_Main; padding-left: 0.278em;">tanh</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.06em; border-left: 0px solid; width: 0px; height: 0.913em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mo>=</mo><mi>tanh</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">h = \tanh</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo&gt;&amp;#x2032;&lt;/mo&gt;&lt;/msup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;u&lt;/mi&gt;&lt;/mrow&gt;&lt;mi mathvariant=&quot;normal&quot;&gt;&amp;#x22A4;&lt;/mi&gt;&lt;/msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2265;&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-610" style="width: 11.537em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.934em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.34em, 1009.86em, 2.672em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-611"><span class="msup" id="MathJax-Span-612"><span style="display: inline-block; position: relative; width: 0.845em; height: 0px;"><span style="position: absolute; clip: rect(3.165em, 1000.56em, 4.116em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-613" style="font-family: MathJax_Math; font-style: italic;">h</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.576em;"><span class="mo" id="MathJax-Span-614" style="font-size: 70.7%; font-family: MathJax_Main;">′</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-615" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-616"><span style="display: inline-block; position: relative; width: 1.456em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.81em, 4.109em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-617"><span class="mrow" id="MathJax-Span-618"><span class="mi" id="MathJax-Span-619" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.831em;"><span class="mi" id="MathJax-Span-620" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="texatom" id="MathJax-Span-621"><span class="mrow" id="MathJax-Span-622"><span class="mi" id="MathJax-Span-623" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-624" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="mi" id="MathJax-Span-625" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">b</span><span class="mo" id="MathJax-Span-626" style="font-family: MathJax_Main;">)</span><span class="msubsup" id="MathJax-Span-627"><span style="display: inline-block; position: relative; width: 1.264em; height: 0px;"><span style="position: absolute; clip: rect(3.409em, 1000.62em, 4.111em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-628"><span class="mrow" id="MathJax-Span-629"><span class="mi" id="MathJax-Span-630" style="font-family: MathJax_Main; font-weight: bold;">u</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -4.345em; left: 0.639em;"><span class="mi" id="MathJax-Span-631" style="font-size: 70.7%; font-family: MathJax_Main;">⊤</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="texatom" id="MathJax-Span-632"><span class="mrow" id="MathJax-Span-633"><span class="mi" id="MathJax-Span-634" style="font-family: MathJax_Main; font-weight: bold;">w</span></span></span><span class="mo" id="MathJax-Span-635" style="font-family: MathJax_Main; padding-left: 0.278em;">≥</span><span class="mo" id="MathJax-Span-636" style="font-family: MathJax_Main; padding-left: 0.278em;">−</span><span class="mn" id="MathJax-Span-637" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.354em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>h</mi><mo>′</mo></msup><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">u</mi></mrow><mi mathvariant="normal">⊤</mi></msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo>≥</mo><mo>−</mo><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-41">h'(\mathbf{w}^\top \mathbf{z} + b) \mathbf{u}^\top \mathbf{w} \geq -1</script>. Note that while <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-638" style="width: 2.547em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.176em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.426em, 1002.08em, 2.672em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-639"><span class="msubsup" id="MathJax-Span-640"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-641" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.49em;"><span class="mi" id="MathJax-Span-642" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-643" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-644"><span class="mrow" id="MathJax-Span-645"><span class="mi" id="MathJax-Span-646" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-647" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">f_\theta(\mathbf{z})</script> is invertible, computing <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-648" style="width: 3.327em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.874em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.302em, 1002.78em, 2.763em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-649"><span class="msubsup" id="MathJax-Span-650"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-651" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.98em, 4.163em, -1000em); top: -4.384em; left: 0.618em;"><span class="texatom" id="MathJax-Span-652"><span class="mrow" id="MathJax-Span-653"><span class="mo" id="MathJax-Span-654" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-655" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1000.41em, 4.112em, -1000em); top: -3.648em; left: 0.49em;"><span class="mi" id="MathJax-Span-656" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-657" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-658"><span class="mrow" id="MathJax-Span-659"><span class="mi" id="MathJax-Span-660" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-661" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.443em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>f</mi><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-43">f_\theta^{-1}(\mathbf{z})</script> could be difficult analytically.  The following models address this problem, where both <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-662" style="width: 1.069em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.903em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.389em, 1000.9em, 2.545em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-663"><span class="msubsup" id="MathJax-Span-664"><span style="display: inline-block; position: relative; width: 0.897em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-665" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.49em;"><span class="mi" id="MathJax-Span-666" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.285em; border-left: 0px solid; width: 0px; height: 1.151em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>f</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-44">f_\theta</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msubsup&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msubsup&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-667" style="width: 1.89em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.601em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.22em, 1001.6em, 2.681em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-668"><span class="msubsup" id="MathJax-Span-669"><span style="display: inline-block; position: relative; width: 1.597em; height: 0px;"><span style="position: absolute; clip: rect(3.154em, 1000.55em, 4.31em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-670" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1000.98em, 4.163em, -1000em); top: -4.384em; left: 0.618em;"><span class="texatom" id="MathJax-Span-671"><span class="mrow" id="MathJax-Span-672"><span class="mo" id="MathJax-Span-673" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-674" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; clip: rect(3.36em, 1000.41em, 4.112em, -1000em); top: -3.648em; left: 0.49em;"><span class="mi" id="MathJax-Span-675" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.443em; border-left: 0px solid; width: 0px; height: 1.504em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup><mi>f</mi><mi>θ</mi><mrow class="MJX-TeXAtom-ORD"><mo>−</mo><mn>1</mn></mrow></msubsup></math></span></span><script type="math/tex" id="MathJax-Element-45">f_\theta^{-1}</script> have simple analytical forms.</p>

<p>The Nonlinear Independent Components Estimation (NICE) model and Real
 Non-Volume Preserving (RealNVP) model composes two kinds of invertible 
transformations: additive coupling layers and rescaling layers. The 
coupling layer in NICE partitions a variable <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-676" style="width: 0.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.732em, 1000.44em, 2.422em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-677"><span class="texatom" id="MathJax-Span-678"><span class="mrow" id="MathJax-Span-679"><span class="mi" id="MathJax-Span-680" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.61em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-46">\mathbf{z}</script> into two disjoints subsets, say <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-681" style="width: 1.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.944em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.65em, 1000.94em, 2.49em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-682"><span class="msubsup" id="MathJax-Span-683"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-684"><span class="mrow" id="MathJax-Span-685"><span class="mi" id="MathJax-Span-686" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-687" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.222em; border-left: 0px solid; width: 0px; height: 0.784em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-47">\mathbf{z}_1</script> and <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-688" style="width: 1.11em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.944em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.65em, 1000.94em, 2.49em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-689"><span class="msubsup" id="MathJax-Span-690"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-691"><span class="mrow" id="MathJax-Span-692"><span class="mi" id="MathJax-Span-693" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-694" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.222em; border-left: 0px solid; width: 0px; height: 0.784em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>2</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-48">\mathbf{z}_2</script>. Then it applies the following transformation:</p>

<p>Forward mapping <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-695" style="width: 3.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.668em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.665em, 1002.65em, 2.433em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-696"><span class="texatom" id="MathJax-Span-697"><span class="mrow" id="MathJax-Span-698"><span class="mi" id="MathJax-Span-699" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span class="mo" id="MathJax-Span-700" style="font-family: MathJax_Main; padding-left: 0.278em;">→</span><span class="texatom" id="MathJax-Span-701" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-702"><span class="mi" id="MathJax-Span-703" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.06em; border-left: 0px solid; width: 0px; height: 0.701em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mo stretchy="false">→</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-49">\mathbf{z} \to \mathbf{x}</script></p>
<ol>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-704" style="width: 3.861em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.325em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.65em, 1003.33em, 2.49em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-705"><span class="msubsup" id="MathJax-Span-706"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.59em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-707"><span class="mrow" id="MathJax-Span-708"><span class="mi" id="MathJax-Span-709" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.607em;"><span class="mn" id="MathJax-Span-710" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-711" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-712" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-713"><span class="mrow" id="MathJax-Span-714"><span class="mi" id="MathJax-Span-715" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-716" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.222em; border-left: 0px solid; width: 0px; height: 0.784em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn></msub><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-50">\mathbf{x}_1 = \mathbf{z}_1</script>, which is an identity mapping.</p>
  </li>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-717" style="width: 8.828em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.594em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1007.5em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-718"><span class="msubsup" id="MathJax-Span-719"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.59em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-720"><span class="mrow" id="MathJax-Span-721"><span class="mi" id="MathJax-Span-722" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.607em;"><span class="mn" id="MathJax-Span-723" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-724" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-725" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-726"><span class="mrow" id="MathJax-Span-727"><span class="mi" id="MathJax-Span-728" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-729" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-730" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-731" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.86em, 4.116em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-732" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.878em;"><span class="mi" id="MathJax-Span-733" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-734" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-735"><span class="mrow" id="MathJax-Span-736"><span class="msubsup" id="MathJax-Span-737"><span style="display: inline-block; position: relative; width: 0.993em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-738" style="font-family: MathJax_Main; font-weight: bold;">z</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-739" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-740" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>2</mn></msub><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>2</mn></msub><mo>+</mo><msub><mi>m</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">z</mi><mn mathvariant="bold">1</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-51">\mathbf{x}_2 = \mathbf{z}_2 + m_\theta(\mathbf{z_1})</script>, where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-741" style="width: 1.48em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.273em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.652em, 1001.27em, 2.501em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-742"><span class="msubsup" id="MathJax-Span-743"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.86em, 4.116em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-744" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.878em;"><span class="mi" id="MathJax-Span-745" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.235em; border-left: 0px solid; width: 0px; height: 0.795em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>m</mi><mi>θ</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-52">m_\theta</script> is a neural network.</p>
  </li>
</ol>

<p>Inverse mapping <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;&amp;#x2192;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-746" style="width: 3.122em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.668em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.665em, 1002.62em, 2.433em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-747"><span class="texatom" id="MathJax-Span-748"><span class="mrow" id="MathJax-Span-749"><span class="mi" id="MathJax-Span-750" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span class="mo" id="MathJax-Span-751" style="font-family: MathJax_Main; padding-left: 0.278em;">→</span><span class="texatom" id="MathJax-Span-752" style="padding-left: 0.278em;"><span class="mrow" id="MathJax-Span-753"><span class="mi" id="MathJax-Span-754" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.06em; border-left: 0px solid; width: 0px; height: 0.701em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mo stretchy="false">→</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-53">\mathbf{x} \to \mathbf{z}</script>:</p>
<ol>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-755" style="width: 3.861em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.325em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.65em, 1003.33em, 2.49em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-756"><span class="msubsup" id="MathJax-Span-757"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-758"><span class="mrow" id="MathJax-Span-759"><span class="mi" id="MathJax-Span-760" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-761" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-762" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-763" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.59em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-764"><span class="mrow" id="MathJax-Span-765"><span class="mi" id="MathJax-Span-766" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.607em;"><span class="mn" id="MathJax-Span-767" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.222em; border-left: 0px solid; width: 0px; height: 0.784em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>1</mn></msub><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>1</mn></msub></math></span></span><script type="math/tex" id="MathJax-Element-54">\mathbf{z}_1 = \mathbf{x}_1</script>, which is an identity mapping.</p>
  </li>
  <li>
    <p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-768" style="width: 8.91em; display: inline-block;"><span style="display: inline-block; position: relative; width: 7.677em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1007.58em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-769"><span class="msubsup" id="MathJax-Span-770"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.46em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-771"><span class="mrow" id="MathJax-Span-772"><span class="mi" id="MathJax-Span-773" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.511em;"><span class="mn" id="MathJax-Span-774" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-775" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="msubsup" id="MathJax-Span-776" style="padding-left: 0.278em;"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.59em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="texatom" id="MathJax-Span-777"><span class="mrow" id="MathJax-Span-778"><span class="mi" id="MathJax-Span-779" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.607em;"><span class="mn" id="MathJax-Span-780" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-781" style="font-family: MathJax_Main; padding-left: 0.222em;">−</span><span class="msubsup" id="MathJax-Span-782" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.417em, 1000.86em, 4.116em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-783" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.828em; left: 0.878em;"><span class="mi" id="MathJax-Span-784" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span><span class="mo" id="MathJax-Span-785" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-786"><span class="mrow" id="MathJax-Span-787"><span class="msubsup" id="MathJax-Span-788"><span style="display: inline-block; position: relative; width: 1.089em; height: 0px;"><span style="position: absolute; clip: rect(3.415em, 1000.59em, 4.105em, -1000em); top: -3.982em; left: 0em;"><span class="mi" id="MathJax-Span-789" style="font-family: MathJax_Main; font-weight: bold;">x</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span><span style="position: absolute; top: -3.832em; left: 0.607em;"><span class="mn" id="MathJax-Span-790" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span><span style="display: inline-block; width: 0px; height: 3.982em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-791" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>2</mn></msub><mo>=</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>2</mn></msub><mo>−</mo><msub><mi>m</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">x</mi><mn mathvariant="bold">1</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-55">\mathbf{z}_2 = \mathbf{x}_2 - m_\theta(\mathbf{x_1})</script>, which is the inverse of the forward transformation.</p>
  </li>
</ol>

<p>Therefore, the Jacobian of the forward mapping is lower trangular, 
whose determinant is simply the product of the elements on the diagonal,
 which is 1. Therefore, this defines a volume preserving transformation.
 RealNVP adds scaling factors to the transformation:</p>

<div class="mathblock"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display" style="text-align: center;"><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="text-align: center; position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;exp&lt;/mi&gt;&lt;mo&gt;&amp;#x2061;&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;mn&gt;2&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;&amp;#x03B8;&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msub&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;mn mathvariant=&quot;bold&quot;&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-792" style="width: 15.826em; display: inline-block;"><span style="display: inline-block; position: relative; width: 13.64em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.396em, 1013.55em, 2.625em, -1000em); top: -2.261em; left: 0em;"><span class="mrow" id="MathJax-Span-793"><span class="msubsup" id="MathJax-Span-794"><span style="display: inline-block; position: relative; width: 1.036em; height: 0px;"><span style="position: absolute; clip: rect(3.426em, 1000.59em, 4.1em, -1000em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-795"><span class="mrow" id="MathJax-Span-796"><span class="mi" id="MathJax-Span-797" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.607em;"><span class="mn" id="MathJax-Span-798" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-799" style="font-family: MathJax_Main; padding-left: 0.278em;">=</span><span class="mi" id="MathJax-Span-800" style="font-family: MathJax_Main; padding-left: 0.278em;">exp</span><span class="mo" id="MathJax-Span-801"></span><span class="mo" id="MathJax-Span-802" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-803"><span style="display: inline-block; position: relative; width: 0.876em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.42em, 4.11em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-804" style="font-family: MathJax_Math; font-style: italic;">s</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.469em;"><span class="mi" id="MathJax-Span-805" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-806" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-807"><span style="display: inline-block; position: relative; width: 0.873em; height: 0px;"><span style="position: absolute; clip: rect(3.439em, 1000.4em, 4.1em, -1000em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-808"><span class="mrow" id="MathJax-Span-809"><span class="mi" id="MathJax-Span-810" style="font-family: MathJax_Main;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.444em;"><span class="mn" id="MathJax-Span-811" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-812" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-813" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-814" style="font-family: MathJax_Main; padding-left: 0.222em;">⊙</span><span class="msubsup" id="MathJax-Span-815" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.426em, 1000.46em, 4.1em, -1000em); top: -3.985em; left: 0em;"><span class="texatom" id="MathJax-Span-816"><span class="mrow" id="MathJax-Span-817"><span class="mi" id="MathJax-Span-818" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.511em;"><span class="mn" id="MathJax-Span-819" style="font-size: 70.7%; font-family: MathJax_Main;">2</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-820" style="font-family: MathJax_Main; padding-left: 0.222em;">+</span><span class="msubsup" id="MathJax-Span-821" style="padding-left: 0.222em;"><span style="display: inline-block; position: relative; width: 1.285em; height: 0px;"><span style="position: absolute; clip: rect(3.428em, 1000.86em, 4.111em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-822" style="font-family: MathJax_Math; font-style: italic;">m</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.831em; left: 0.878em;"><span class="mi" id="MathJax-Span-823" style="font-size: 70.7%; font-family: MathJax_Math; font-style: italic;">θ</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span><span class="mo" id="MathJax-Span-824" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-825"><span class="mrow" id="MathJax-Span-826"><span class="msubsup" id="MathJax-Span-827"><span style="display: inline-block; position: relative; width: 0.993em; height: 0px;"><span style="position: absolute; clip: rect(3.426em, 1000.46em, 4.1em, -1000em); top: -3.985em; left: 0em;"><span class="mi" id="MathJax-Span-828" style="font-family: MathJax_Main; font-weight: bold;">z</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span><span style="position: absolute; top: -3.835em; left: 0.511em;"><span class="mn" id="MathJax-Span-829" style="font-size: 70.7%; font-family: MathJax_Main; font-weight: bold;">1</span><span style="display: inline-block; width: 0px; height: 3.985em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-830" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.261em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.334em; border-left: 0px solid; width: 0px; height: 1.249em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow><mn>2</mn></msub><mo>=</mo><mi>exp</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>s</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">z</mi></mrow><mn>1</mn></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>⊙</mo><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow><mn>2</mn></msub><mo>+</mo><msub><mi>m</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msub><mi mathvariant="bold">z</mi><mn mathvariant="bold">1</mn></msub></mrow><mo stretchy="false">)</mo></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-56">

\mathbf{x}_2 = \exp(s_\theta(\mathbb{z}_1)) \odot \mathbf{z}_2 + m_\theta(\mathbf{z_1})

</script></div>

<p>where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mo&gt;&amp;#x2299;&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-831" style="width: 0.905em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.78em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.511em, 1000.72em, 2.423em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-832"><span class="mo" id="MathJax-Span-833" style="font-family: MathJax_Main;">⊙</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.144em; border-left: 0px solid; width: 0px; height: 0.868em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo>⊙</mo></math></span></span><script type="math/tex" id="MathJax-Element-57">\odot</script> denotes elementwise product. This results in a non-volume preserving transformation.</p>

<p>Some autoregressive models can also be interpreted as flow models. 
For a Gaussian autoregressive model, one receive some Gaussian noise for
 each dimension of <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;double-struck&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-834" style="width: 0.618em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.534em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.663em, 1000.52em, 2.34em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-835"><span class="texatom" id="MathJax-Span-836"><span class="mrow" id="MathJax-Span-837"><span class="mi" id="MathJax-Span-838" style="font-family: MathJax_Main;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.595em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="double-struck">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-58">\mathbb{x}</script>, which can be treated as the latent variables <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-839" style="width: 0.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.732em, 1000.44em, 2.422em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-840"><span class="texatom" id="MathJax-Span-841"><span class="mrow" id="MathJax-Span-842"><span class="mi" id="MathJax-Span-843" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.61em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-59">\mathbf{z}</script>. Such transformations are also invertible, meaning that given <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-844" style="width: 0.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.732em, 1000.6em, 2.422em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-845"><span class="texatom" id="MathJax-Span-846"><span class="mrow" id="MathJax-Span-847"><span class="mi" id="MathJax-Span-848" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.61em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-60">\mathbf{x}</script> and the model parameters, we can obtain <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;z&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-849" style="width: 0.577em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.493em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.732em, 1000.44em, 2.422em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-850"><span class="texatom" id="MathJax-Span-851"><span class="mrow" id="MathJax-Span-852"><span class="mi" id="MathJax-Span-853" style="font-family: MathJax_Main; font-weight: bold;">z</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.61em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">z</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-61">\mathbf{z}</script> exactly.</p>

<p>Masked Autoregressive Flow (MAF) uses this interpretation, where the 
forward mapping is an autoregressive model. However, sampling is 
sequential and slow, in <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;O&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-854" style="width: 2.506em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.135em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.344em, 1002.04em, 2.59em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-855"><span class="mi" id="MathJax-Span-856" style="font-family: MathJax_Math; font-style: italic;">O</span><span class="mo" id="MathJax-Span-857" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-858" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mo" id="MathJax-Span-859" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.338em; border-left: 0px solid; width: 0px; height: 1.255em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi><mo stretchy="false">(</mo><mi>n</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-62">O(n)</script> time where <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-860" style="width: 0.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.652em, 1000.6em, 2.351em, -1000em); top: -2.217em; left: 0em;"><span class="mrow" id="MathJax-Span-861"><span class="mi" id="MathJax-Span-862" style="font-family: MathJax_Math; font-style: italic;">n</span></span><span style="display: inline-block; width: 0px; height: 2.217em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.06em; border-left: 0px solid; width: 0px; height: 0.621em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi></math></span></span><script type="math/tex" id="MathJax-Element-63">n</script> is the dimension of the samples.</p>

<p><img src="Normalizing%20Flow%20Models_files/maf.html" alt=""></p>

<p>To address the sampling problem, the Inverse Autoregressive Flow 
(IAF) simply inverts the generating process. In this case, generating <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-863" style="width: 0.741em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.616em; height: 0px; font-size: 116%;"><span style="position: absolute; clip: rect(1.732em, 1000.6em, 2.422em, -1000em); top: -2.299em; left: 0em;"><span class="mrow" id="MathJax-Span-864"><span class="texatom" id="MathJax-Span-865"><span class="mrow" id="MathJax-Span-866"><span class="mi" id="MathJax-Span-867" style="font-family: MathJax_Main; font-weight: bold;">x</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.299em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.048em; border-left: 0px solid; width: 0px; height: 0.61em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">x</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-64">\mathbf{x}</script>
 from the noise can be parallelized, but computing the likelihood of new
 data points is slow. However, for generated points the likelihood can 
be computed efficiently (since the noise are already obtained).</p>

<p><img src="Normalizing%20Flow%20Models_files/iaf.html" alt=""></p>

<p>Parallel WaveNet combines the best of both worlds for IAF and MAF 
where it uses an IAF student model to retrieve sample and a MAF teacher 
model to compute likelihood. The teacher model can be efficiently 
trained via maximum likelihood, and the student model is trained by 
minimizing the KL divergence between itself and the teacher model. Since
 computing the IAF likelihood for an IAF sample is efficient, this 
process is efficient.</p>

<h1 id="footnotes">Footnotes</h1>

<div class="footnotes">
  <ol>
    <li id="fn:nf">
      <p>Recall the conditions for change of variable formula.&nbsp;<a href="#fnref:nf" class="reversefootnote">↩</a></p>
    </li>
  </ol>
</div>



    </article>
    <span class="print-footer">Normalizing Flow Models - Aditya Grover</span>
    <footer>
  <hr class="slender">
  <!-- <ul class="footer&#45;links"> -->
  <!--   <li><a href="mailto:hate@spam.net"><span class="icon&#45;mail"></span></a></li>     -->
  <!--    -->
  <!--     <li> -->
  <!--       <a href="//www.twitter.com/twitter_handle"><span class="icon-twitter"></span></a> -->
  <!--     </li> -->
  <!--    -->
  <!--     <li> -->
  <!--       <a href="//plus.google.com/+googlePlusName"><span class="icon-googleplus"></span></a> -->
  <!--     </li> -->
  <!--    -->
  <!--     <li> -->
  <!--       <a href="//github.com/GithubHandle"><span class="icon-github"></span></a> -->
  <!--     </li> -->
  <!--    -->
  <!--     <li> -->
  <!--       <a href="//www.flickr.com/photos/FlickrUserID"><span class="icon-flickr"></span></a> -->
  <!--     </li> -->
  <!--    -->
  <!--     <li> -->
  <!--       <a href="/feed"><span class="icon-feed"></span></a> -->
  <!--     </li> -->
  <!--      -->
  <!-- </ul> -->
<div class="credits">
<!-- <span>&#38;copy; 2018 <!&#45;&#45; &#38;#38;nbsp;&#38;#38;nbsp;ADITYA GROVER &#45;&#45;></span></br> <br> -->
<span>Site created with <a href="https://jekyllrb.com/">Jekyll</a> using the <a href="https://github.com/clayh53/tufte-jekyll">Tufte theme</a>. © 2018</span> 
</div>  
</footer>

  

<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px none; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px none; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-size-adjust: none; font-family: MathJax_Size4, sans-serif;"></div></div></body></html>